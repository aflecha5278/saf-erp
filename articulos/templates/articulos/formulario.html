{% extends "articulos/base.html" %}
{% load widget_tweaks %}

{% block title %}
{% if form.instance.pk %}Modificar art√≠culo{% else %}Agregar art√≠culo{% endif %} - SAF ERP
{% endblock %}

{% block content %}
<div class="list-container">
    <div class="list-card">
        <h1>{% if form.instance.pk %}Modificar art√≠culo{% else %}Agregar art√≠culo{% endif %}</h1>

        {% if form.errors %}
            <div class="error-message">
                {% for field, errors in form.errors.items %}
                    {% for error in errors %}
                        {{ field|title }}: {{ error }}<br>
                    {% endfor %}
                {% endfor %}
            </div>
        {% endif %}

        <!-- ‚úÖ FORMULARIO √öNICO -->
        <form method="post" id="articuloForm">
            {% csrf_token %}

            <div class="form-group" style="display:flex; align-items:center; gap:10px;">
                {{ form.codart.label_tag }} {{ form.codart }}
                {{ form.deposito.label_tag }} {{ form.deposito }}
            </div>
            <div class="form-group">
                {{ form.descrip.label_tag }} {{ form.descrip }}
            </div>
            <div class="form-group" style="display:flex; align-items:center; gap:10px;">
                {{ form.marca.label_tag }} {{ form.marca }} √≥
                {{ form.marca_nueva.label_tag }} {{ form.marca_nueva }}
            </div>
            <div class="form-group" style="display:flex; align-items:center; gap:10px;">
                {{ form.rubro.label_tag }} {{ form.rubro }} √≥
                {{ form.rubro_nueva.label_tag }} {{ form.rubro_nueva }}
            </div>
            <div class="form-group" style="display:flex; align-items:center; gap:10px;">
                {{ form.subrubro.label_tag }} {{ form.subrubro }} √≥
                {{ form.subrubro_nueva.label_tag }} {{ form.subrubro_nueva }}
            </div>

            <!-- ‚úÖ TABS -->
            <div class="container mt-4">
                <ul class="nav nav-tabs" id="articuloTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="page1-tab" data-bs-toggle="tab" data-bs-target="#page1" type="button" role="tab">Al p√∫blico</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="page2-tab" data-bs-toggle="tab" data-bs-target="#page2" type="button" role="tab">Moneda extranj.</button>
                    </li>
                </ul>

                <div class="tab-content" id="articuloTabsContent">
                    <div class="tab-pane fade show active p-3" id="page1" role="tabpanel">
                        {% include "articulos/_form_precio.html" %}
                    </div>
                    <div class="tab-pane fade p-3" id="page2" role="tabpanel">
                        <p>Aqu√≠ van los campos de la p√°gina 2 (otros datos del art√≠culo)</p>
                    </div>
                </div>
            </div>

            <!-- ‚úÖ BOTONES -->
            <div class="actions mt-3">
                <button type="submit" class="btn btn-primary">Guardar</button>
                <button type="button" class="btn btn-danger" onclick="window.location.href='{% url 'lista_articulos' %}'">
                    Volver a la lista
                </button>
            </div>
        </form>
        <!-- üö´ YA NO HAY FORM ANIDADO -->
    </div>
</div>
{% endblock %}
